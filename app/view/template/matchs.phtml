<?php
/**
 * User: corpas
 * Date: 08/05/16
 * Time: 21:08
 */
/** @var MatchsController $_match */
$_match = $this;
$_utilisateur = Access::getInstance()->getCurrentUser();
$_matchsCollection = $_match->getAllMatch();
$_pariCollection = new PariCollection();
$_equipeCollection = new EquipeCollection();
/** Début tableau matchs **/
?>
<div>
	<form action="">
		<table class="table table-striped">
			<tr>
				<th>Date</th>
				<th>Image 1</th>
				<th>Equipe 1</th>
				<th>Score</th>
				<th>Equipe 2</th>
				<th>Image 2</th>
			</tr>
			<?php
			/** @var MatchModel $match */
			foreach ($_matchsCollection as $match):
				/* Récuperer le score du match réel si déjà joué, sinon "-" */
				$equipe_1 = $_equipeCollection->loadById($match->getAttribute('equipe_id_1'));
				$equipe_2 = $_equipeCollection->loadById($match->getAttribute('equipe_id_2'));
				$pari = $_match->getPari($match);
				?>
				<tr>
					<td><?php echo $match->getAttribute("date") ?></td>
					<td><?php echo '<img width="35px" src="'.$_match->getUrlImage('/pays/' . $equipe_1->getAttribute('image')) . '" />' ?></td>
					<td><?php echo $equipe_1->getAttribute('name') ?></td>
					<td>
						<input type="number" name="score_equipe_1" value="<?php echo ($pari)?$pari->getAttribute("score_equipe_1")?>"> - <input type="number" name="score_equipe_2" value="<?php echo ($pari)?$pari->getAttribute("score_equipe_2")?>">
						<span class="small_grey"><?php echo $match->getScore('score_equipe_1')." - ".$match->getScore('score_equipe_2') ?></span>
					</td>
					<td><?php echo $equipe_2->getAttribute('name') ?></td>
					<td><?php echo '<img width="35px" src="'.$_match->getUrlImage('/pays/' . $equipe_2->getAttribute('image')) . '" />' ?></td>
				</tr>
			<?php endforeach; ?>
		</table>
	</form>
</div>
