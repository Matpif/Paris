<?php
/**
 * User: corpas
 * Date: 08/05/16
 * Time: 21:08
 */
/** @var AccueilController $_accueil */
$_accueil = $this;
$_utilisateur = $_profil->getUtilisateur();

/** Début tableau matchs **/
?>
<div>
	<table class="table table-striped">
		<tr>
			<th>Date</th>
			<th>Image 1</th>
			<th>Equipe 1</th>
			<th>Score</th>
			<th>Equipe 2</th>
			<th>Image 2</th>
		</tr>
<?

$collection_matchs = new MatchCollection();
$collection_matchs->loadAll('date');

$collection_paris = new PariCollection();

/** @var MatchModel $match */
foreach ($collection_matchs as $match):
	/* Récuperer le score du match réel si déjà joué, sinon "-" */
	$equipe_1 = (new EquipeCollection())->loadById($match->getAttribute('equipe_id_1'));
    $equipe_2 = (new EquipeCollection())->loadById($match->getAttribute('equipe_id_2'));

    $pari = $collection_paris->load(array("utilisateur_id" => $_utilisateur->getAttribute('utilisateur_id'), "match_id" => $match->getAttribute('id')));
?>
		<tr>
			<td><? echo $match->getAttribute("date") ?></td>
			<td><? echo '<img width="35px" src="/images/pays/' . $equipe_1->getAttribute('image') . '" />' ?></td>
			<td><? echo $equipe_1->getAttribute('name') ?></td>
			<td>
				<? echo $pari->getAttribute("score_equipe_1")." - ".$pari->getAttribute("score_equipe_1") ?>
				<span class="small_grey"><? echo $match->getAttribute('score_equipe_1')." - ".$match->getAttribute('score_equipe_2') ?></span>
			</td>
			<td><? echo $equipe_2->getAttribute('name') ?></td>
			<td><? echo '<img width="35px" src="/images/pays/' . $equipe_2->getAttribute('image') . '" />' ?></td>
		</tr>
<?
endfor;
?>
	</table>
</div>